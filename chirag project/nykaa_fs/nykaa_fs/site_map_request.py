from curl_cffi import requests
from nykaa_fs.config.database_config import ConfigDatabase
from parsel import Selector

db = ConfigDatabase(database='nykaa_fs', table='site_map')

cookies = {
    'bcookie': 'acada8b9-f715-48e7-9dd8-0dc9a7cbceaf',
    'EXP_NEW_SIGN_UP': 'DEFAULT',
    'EXP_ITEM_DISCOUNT': 'DEFAULT',
    'EXP_CART_LOGIN_SEGMENT': 'A',
    'EXP_ADP_RV_REORDER': 'B',
    'EXP_ADP_RV_SEGMENT': 'A',
    'EXP_AB_AUTOFILL': 'B',
    'EXP_ADP_RV_VIEW_SIMILAR_HLP': 'A',
    'EXP_ADP_RV_PLP_CONFIGURABLE_NO_RESULTS': 'A',
    'EXP_ADP_RV_PRODUCT_V3': 'CONTROL',
    'EXP_AB_HLP_CARD_REVAMP': 'CONTROL',
    'EXP_AB_WISHLIST': 'A',
    'EXP_AB_PRICE_REVEAL_NEW': 'A',
    'EXP_EDD_DELIVERY_WIDGET': 'A',
    'EXP_ADP_RV_MULTI_COUPONS': 'A',
    'EXP_AB_DWEB_MULTICOUPON': 'A',
    'EXP_ADP_RV_SEARCH_BAR_NEW': 'A',
    'EXP_AB_AUTH_PAGE': 'A',
    'EXP_AB_AUTH_DWEB': 'CONTROL',
    'EXP_INCORRECT_SLUG_REDIRECT': 'A',
    'EXP_SLP_RELATED_SEARCHES': 'A',
    'EXP_AB_HLP_CTA': 'A',
    'EXP_AB_PDP_IMAGE': 'DEFAULT',
    'EXP_AB_CALLOUT_NUDGE': 'A',
    'EXP_AB_PRICE_REVAMP': 'A',
    'EXP_AB_TRUECALLER': 'DEFAULT',
    'EXP_AB_GOOGLE_ONE_TAP': 'DEFAULT',
    'EXP_AB_HLP_PAGE': 'A',
    'EXP_ORGANIC_GUIDES': 'A',
    'EXP_AB_NEW_PLP': 'A',
    'EXP_PDP_RATING_REVAMP': 'A',
    'EXP_AB_BREADCRUMB_POSITION': 'A',
    'EXP_PRODUCT_CARD_CTA': 'A',
    'EXP_AB_MULTI_MRP': 'A',
    'EXP_AB_BRAND_SEP_PDP': 'A',
    'EXP_AB_TOP_NAV_CONFIG': 'CONTROL',
    'EXP_QUERY_PARAM_EXP_DWEB': 'CONTROL',
    'EXP_AB_BEAUTY_PORTFOLIO': 'A',
    'EXP_AB_HAMBURGUR_BANNER': 'A',
    'EXP_AB_HP_SEARCH_ANIMATION': 'CONTROL',
    'EXP_AB_PDP_HAMBURGER': 'CONTROL',
    'EXP_AB_RECO_PRODUCT_V4': 'A',
    'EXP_AB_WEB_AUTOREAD_OTP': 'A',
    'EXP_AD_BRV': 'random',
    'EXP_PDP_RELEVANT_CATEGORY': 'A',
    'EXP_AB_PRODUCT_HIGHLIGHTS_CAROUSEL': 'A',
    'EXP_AB_PR_FLASH_SALE_V5': 'A',
    'EXP_AB_PRICE_FLUCTUATION': 'A',
    'EXP_AB_IOC_CART_NUDGE': 'A',
    'EXP_SNP_PRICE_FLUCTUATION_NUDGE': 'A',
    'run': '46',
    'EXP_REVIEW_COLLECTION': '1',
    'D_LST': '1',
    'D_PDP': '1',
    'PHPSESSID': 'NY4lOPgb9G5gIfD1721109091120',
    '_gcl_aw': 'GCL.1721109094.Cj0KCQjwkdO0BhDxARIsANkNcrf0fk3XIrfR8dP7WAzqMrnpdARbk1VHv06pQAeHP9aHdBBVj5gn8x0aAk6LEALw_wcB',
    '_gcl_gs': '2.1.k1$i1721109090',
    '_gcl_au': '1.1.692116432.1721109094',
    '_gac_UA-31866293-9': '1.1721109094.Cj0KCQjwkdO0BhDxARIsANkNcrf0fk3XIrfR8dP7WAzqMrnpdARbk1VHv06pQAeHP9aHdBBVj5gn8x0aAk6LEALw_wcB',
    'WZRK_G': '8be39919e4284de1b38e70092d24204c',
    '_ttgclid': 'Cj0KCQjwkdO0BhDxARIsANkNcrf0fk3XIrfR8dP7WAzqMrnpdARbk1VHv06pQAeHP9aHdBBVj5gn8x0aAk6LEALw_wcB',
    '_ttgclid': 'Cj0KCQjwkdO0BhDxARIsANkNcrf0fk3XIrfR8dP7WAzqMrnpdARbk1VHv06pQAeHP9aHdBBVj5gn8x0aAk6LEALw_wcB',
    '_ttgclid': 'Cj0KCQjwkdO0BhDxARIsANkNcrf0fk3XIrfR8dP7WAzqMrnpdARbk1VHv06pQAeHP9aHdBBVj5gn8x0aAk6LEALw_wcB',
    'EXP_PLP_INLINE_FILTER': 'REVAMPED',
    'EXP_PLP_PINKBOX_CTA': 'CONTROL',
    'EXP_AB_HLP_OFFERS': 'DEFAULT',
    'EXP_AB_AUTO_FILL_OTP': 'A',
    'EXP_AB_REMOVE_LOGIN_BOTTOMSHEET': 'DEFAULT',
    'EXP_AB_HORIZONTAL_WIDGET_TYPE': 'CONTROL',
    'EXP_AB_SOCIAL_PROOF_HLP': 'O_7',
    'deduplication_cookie': 'Desktop_web_footer',
    'deduplication_cookie': 'Desktop_web_footer',
    'tt_deduplication_cookie': 'Desktop_web_footer',
    'tt_deduplication_cookie': 'Desktop_web_footer',
    'tt_deduplication_cookie': 'Desktop_web_footer',
    'btIdentify': '3e62843b-7afb-4714-b33a-680697756594',
    '_bti': '%7B%22bsin%22%3A%22%22%7D',
    'unbxd.userId': 'uid-1723446894716-374',
    'AMCV_FE9A65E655E6E38A7F000101%40AdobeOrg': '2121618341%7CMCIDTS%7C19948%7CMCMID%7C92083031616342837933557661350989532064%7CMCAAMLH-1724051694%7C12%7CMCAAMB-1724051694%7CRKhpRz8krg2tLO6pguXWp5olkAcUniQYPHaMWWgdJ3xzPWQmdj0y%7CMCOPTOUT-1723454094s%7CNONE%7CMCAID%7CNONE',
    'EXP_AB_PRODUCT_VARIENTS_ORDER': 'CONTROL',
    'EXP_AB_ZENDESK_CHAT': 'A',
    'EXP_ADP_RV_VIEW_SIMILAR': 'C',
    'cto_bundle': '7Nog8192dXRidU8zZURHbkRUT20yYUZVc2VnckFhQ1ptT1RsMSUyRk5LSmk1cGklMkZaUiUyQkJvJTJCdlZFYk9SSHN1cFdYYSUyRkF5Z1YlMkI3bHhNZmp2WXRzTiUyQlJlRU1wVjZNajZGYkxPcVZBJTJGNVQxbDNPWXdQRHdqcnFRTUZ3OFY1a1p1YkNJJTJCcW8lMkYxQzFSalExS1lHVFRMb1JxYmI2ODliZyUzRCUzRA',
    'EXP_QUERY_PARAM_EXP': 'C',
    'EXP_AB_DWEB_SHOPPING_BAG_URL': 'A',
    'EXP_CART_GRATIFICATION_POPUP': 'B',
    'EXP_EXP_MULTI_COUPONS_REVAMP': 'DEFAULT',
    'EXP_FULL_SCREEN_RECO_WIDGET': 'DEFAULT',
    'EXP_AB_BEST_SELLER_PDP': 'DEFAULT',
    'head_data_react': '{"id":"","nykaa_pro":false,"group_id":""}',
    'pro': 'false',
    '_gid': 'GA1.2.2107984782.1727694364',
    'EXP_AB_PDP_HOME': 'B',
    'EXP_UPDATED_AT': '1727419820573',
    'EXP_SSR_CACHE': '99cf67f030175c1bfc05c248abd5abf2',
    'SITE_VISIT_COUNT': '300',
    'cf_clearance': '53N_Ap_g2Quv2Y1eGfaNjTJF61f4Y8A20zDe.vxQY10-1727765179-1.2.1.1-M4uc_WP5olffI8HK0UfjRxfwZR7JFGHmtE5xEPqSvgKjNWjXj5l841sjBQZ1M3So2_.D_XLyUm1GuxRlXZ3CrxoKLQVpj2L8vfvt06PxxLKOJuRNufmFjPzvjpO5LZUhdAV_h23o.YYN6MJVSfVQk1pcslJ3jUP2UtqnrHIi02ADCkzdyTiHcTG_2RlX.diTiLI5Lb9Z8FpMa_QVQVQHMNZgZUTSLOEAd_MAtY8dDGuKQwAlpkVhepwUZrKzDO0iDcx_D6WUg5sy9zWfy2qBJabW9s9qo1Ct0tAxB_owaJ4DHHDgid4hjBVlSS8nbFCJVICLteHv0Hq6u09mNkB6L93OhOdg.4fKNIzk8Hj1KXmB31DRwI1y9RteJ9zTftAz',
    '_ga': 'GA1.2.1291350165.1720180102',
    '_ga_JQ1CQHSXRX': 'GS1.2.1727765175.39.0.1727765175.60.0.0',
    '_ga_LKNEBVRZRG': 'GS1.1.1727765174.45.0.1727765188.46.0.0',
    '__cf_bm': 'rztOoXEcC261qTd3QQcWQOUG803gu4xMxb8wy3TSYZ8-1727772635-1.0.1.1-VLbItTJ59744hNmzXWozM_6n5VHnnn3BQNSqEIHJbWWd37DJro_c2XkeHGXouBX.0BD2Cw0KYpAaHe.B3QpTVw',
    '_cfuvid': 'lvDxv2D2vtH670gdWaMpKc9SFWIWTrStViYvCzAQdOY-1727772635385-0.0.1.1-604800000',
}
headers = {
    'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',
    'accept-language': 'en-US,en;q=0.9',
    'cache-control': 'max-age=0',
    # 'cookie': 'bcookie=acada8b9-f715-48e7-9dd8-0dc9a7cbceaf; EXP_NEW_SIGN_UP=DEFAULT; EXP_ITEM_DISCOUNT=DEFAULT; EXP_CART_LOGIN_SEGMENT=A; EXP_ADP_RV_REORDER=B; EXP_ADP_RV_SEGMENT=A; EXP_AB_AUTOFILL=B; EXP_ADP_RV_VIEW_SIMILAR_HLP=A; EXP_ADP_RV_PLP_CONFIGURABLE_NO_RESULTS=A; EXP_ADP_RV_PRODUCT_V3=CONTROL; EXP_AB_HLP_CARD_REVAMP=CONTROL; EXP_AB_WISHLIST=A; EXP_AB_PRICE_REVEAL_NEW=A; EXP_EDD_DELIVERY_WIDGET=A; EXP_ADP_RV_MULTI_COUPONS=A; EXP_AB_DWEB_MULTICOUPON=A; EXP_ADP_RV_SEARCH_BAR_NEW=A; EXP_AB_AUTH_PAGE=A; EXP_AB_AUTH_DWEB=CONTROL; EXP_INCORRECT_SLUG_REDIRECT=A; EXP_SLP_RELATED_SEARCHES=A; EXP_AB_HLP_CTA=A; EXP_AB_PDP_IMAGE=DEFAULT; EXP_AB_CALLOUT_NUDGE=A; EXP_AB_PRICE_REVAMP=A; EXP_AB_TRUECALLER=DEFAULT; EXP_AB_GOOGLE_ONE_TAP=DEFAULT; EXP_AB_HLP_PAGE=A; EXP_ORGANIC_GUIDES=A; EXP_AB_NEW_PLP=A; EXP_PDP_RATING_REVAMP=A; EXP_AB_BREADCRUMB_POSITION=A; EXP_PRODUCT_CARD_CTA=A; EXP_AB_MULTI_MRP=A; EXP_AB_BRAND_SEP_PDP=A; EXP_AB_TOP_NAV_CONFIG=CONTROL; EXP_QUERY_PARAM_EXP_DWEB=CONTROL; EXP_AB_BEAUTY_PORTFOLIO=A; EXP_AB_HAMBURGUR_BANNER=A; EXP_AB_HP_SEARCH_ANIMATION=CONTROL; EXP_AB_PDP_HAMBURGER=CONTROL; EXP_AB_RECO_PRODUCT_V4=A; EXP_AB_WEB_AUTOREAD_OTP=A; EXP_AD_BRV=random; EXP_PDP_RELEVANT_CATEGORY=A; EXP_AB_PRODUCT_HIGHLIGHTS_CAROUSEL=A; EXP_AB_PR_FLASH_SALE_V5=A; EXP_AB_PRICE_FLUCTUATION=A; EXP_AB_IOC_CART_NUDGE=A; EXP_SNP_PRICE_FLUCTUATION_NUDGE=A; run=46; EXP_REVIEW_COLLECTION=1; D_LST=1; D_PDP=1; PHPSESSID=NY4lOPgb9G5gIfD1721109091120; _gcl_aw=GCL.1721109094.Cj0KCQjwkdO0BhDxARIsANkNcrf0fk3XIrfR8dP7WAzqMrnpdARbk1VHv06pQAeHP9aHdBBVj5gn8x0aAk6LEALw_wcB; _gcl_gs=2.1.k1$i1721109090; _gcl_au=1.1.692116432.1721109094; _gac_UA-31866293-9=1.1721109094.Cj0KCQjwkdO0BhDxARIsANkNcrf0fk3XIrfR8dP7WAzqMrnpdARbk1VHv06pQAeHP9aHdBBVj5gn8x0aAk6LEALw_wcB; WZRK_G=8be39919e4284de1b38e70092d24204c; _ttgclid=Cj0KCQjwkdO0BhDxARIsANkNcrf0fk3XIrfR8dP7WAzqMrnpdARbk1VHv06pQAeHP9aHdBBVj5gn8x0aAk6LEALw_wcB; _ttgclid=Cj0KCQjwkdO0BhDxARIsANkNcrf0fk3XIrfR8dP7WAzqMrnpdARbk1VHv06pQAeHP9aHdBBVj5gn8x0aAk6LEALw_wcB; _ttgclid=Cj0KCQjwkdO0BhDxARIsANkNcrf0fk3XIrfR8dP7WAzqMrnpdARbk1VHv06pQAeHP9aHdBBVj5gn8x0aAk6LEALw_wcB; EXP_PLP_INLINE_FILTER=REVAMPED; EXP_PLP_PINKBOX_CTA=CONTROL; EXP_AB_HLP_OFFERS=DEFAULT; EXP_AB_AUTO_FILL_OTP=A; EXP_AB_REMOVE_LOGIN_BOTTOMSHEET=DEFAULT; EXP_AB_HORIZONTAL_WIDGET_TYPE=CONTROL; EXP_AB_SOCIAL_PROOF_HLP=O_7; deduplication_cookie=Desktop_web_footer; deduplication_cookie=Desktop_web_footer; tt_deduplication_cookie=Desktop_web_footer; tt_deduplication_cookie=Desktop_web_footer; tt_deduplication_cookie=Desktop_web_footer; btIdentify=3e62843b-7afb-4714-b33a-680697756594; _bti=%7B%22bsin%22%3A%22%22%7D; unbxd.userId=uid-1723446894716-374; AMCV_FE9A65E655E6E38A7F000101%40AdobeOrg=2121618341%7CMCIDTS%7C19948%7CMCMID%7C92083031616342837933557661350989532064%7CMCAAMLH-1724051694%7C12%7CMCAAMB-1724051694%7CRKhpRz8krg2tLO6pguXWp5olkAcUniQYPHaMWWgdJ3xzPWQmdj0y%7CMCOPTOUT-1723454094s%7CNONE%7CMCAID%7CNONE; EXP_AB_PRODUCT_VARIENTS_ORDER=CONTROL; EXP_AB_ZENDESK_CHAT=A; EXP_ADP_RV_VIEW_SIMILAR=C; cto_bundle=7Nog8192dXRidU8zZURHbkRUT20yYUZVc2VnckFhQ1ptT1RsMSUyRk5LSmk1cGklMkZaUiUyQkJvJTJCdlZFYk9SSHN1cFdYYSUyRkF5Z1YlMkI3bHhNZmp2WXRzTiUyQlJlRU1wVjZNajZGYkxPcVZBJTJGNVQxbDNPWXdQRHdqcnFRTUZ3OFY1a1p1YkNJJTJCcW8lMkYxQzFSalExS1lHVFRMb1JxYmI2ODliZyUzRCUzRA; EXP_QUERY_PARAM_EXP=C; EXP_AB_DWEB_SHOPPING_BAG_URL=A; EXP_CART_GRATIFICATION_POPUP=B; EXP_EXP_MULTI_COUPONS_REVAMP=DEFAULT; EXP_FULL_SCREEN_RECO_WIDGET=DEFAULT; EXP_AB_BEST_SELLER_PDP=DEFAULT; head_data_react={"id":"","nykaa_pro":false,"group_id":""}; pro=false; _gid=GA1.2.2107984782.1727694364; EXP_AB_PDP_HOME=B; EXP_UPDATED_AT=1727419820573; EXP_SSR_CACHE=99cf67f030175c1bfc05c248abd5abf2; SITE_VISIT_COUNT=300; cf_clearance=53N_Ap_g2Quv2Y1eGfaNjTJF61f4Y8A20zDe.vxQY10-1727765179-1.2.1.1-M4uc_WP5olffI8HK0UfjRxfwZR7JFGHmtE5xEPqSvgKjNWjXj5l841sjBQZ1M3So2_.D_XLyUm1GuxRlXZ3CrxoKLQVpj2L8vfvt06PxxLKOJuRNufmFjPzvjpO5LZUhdAV_h23o.YYN6MJVSfVQk1pcslJ3jUP2UtqnrHIi02ADCkzdyTiHcTG_2RlX.diTiLI5Lb9Z8FpMa_QVQVQHMNZgZUTSLOEAd_MAtY8dDGuKQwAlpkVhepwUZrKzDO0iDcx_D6WUg5sy9zWfy2qBJabW9s9qo1Ct0tAxB_owaJ4DHHDgid4hjBVlSS8nbFCJVICLteHv0Hq6u09mNkB6L93OhOdg.4fKNIzk8Hj1KXmB31DRwI1y9RteJ9zTftAz; _ga=GA1.2.1291350165.1720180102; _ga_JQ1CQHSXRX=GS1.2.1727765175.39.0.1727765175.60.0.0; _ga_LKNEBVRZRG=GS1.1.1727765174.45.0.1727765188.46.0.0; __cf_bm=rztOoXEcC261qTd3QQcWQOUG803gu4xMxb8wy3TSYZ8-1727772635-1.0.1.1-VLbItTJ59744hNmzXWozM_6n5VHnnn3BQNSqEIHJbWWd37DJro_c2XkeHGXouBX.0BD2Cw0KYpAaHe.B3QpTVw; _cfuvid=lvDxv2D2vtH670gdWaMpKc9SFWIWTrStViYvCzAQdOY-1727772635385-0.0.1.1-604800000',
    'if-modified-since': 'Sun, 29 Sep 2024 22:38:31 GMT',
    'if-none-match': 'W/"0037797c8abdac4a6d6d78b3fd4ba3ea"',
    'priority': 'u=0, i',
    'sec-ch-ua': '"Google Chrome";v="129", "Not=A?Brand";v="8", "Chromium";v="129"',
    'sec-ch-ua-mobile': '?0',
    'sec-ch-ua-platform': '"Windows"',
    'sec-fetch-dest': 'document',
    'sec-fetch-mode': 'navigate',
    'sec-fetch-site': 'none',
    'sec-fetch-user': '?1',
    'upgrade-insecure-requests': '1',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36',
}

response = requests.get('https://www.nykaa.com/sitemap-v2/sitemap-products-1.xml', cookies=cookies, headers=headers)

data = Selector(text=response.text)
links = data.xpath('//loc/text()').getall()
for link in links:
    item = {
        'link': link
    }
    db.insertItemToSql(item=item)
